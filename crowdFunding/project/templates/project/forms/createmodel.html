
{% load static %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<h1>hello from create Project</h1>
<div class="container">
    
    <form method="post" enctype="multipart/form-data" id="project-form">
        {% csrf_token %}
        {{ form}} {# Display ProjectModelForm fields #}
            
        <!-- Display PictureModelForm fields -->
        <label for="pic">Pictures</label>
        <input type="file" name="pic" id="pic" multiple class="form-control" id="project-form">
        
        <div id="error-message" class="text-danger" style="display: none;"></div>
        <button type="submit" id="submit-button" class="btn btn-success">Submit</button>
    </form>
</div>

<script src = "{% static 'project/js/script.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>
<script>
    
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('project-form').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission
        
        // Fetch the data from the form
        var formData = new FormData(this);
        
        // Submit the form data via fetch
        fetch(this.action, {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            // Check if there's an error message in the response
            if (data.error) {
                var errorMessageElement = document.getElementById('error-message');
                errorMessageElement.textContent = data.error;
                errorMessageElement.style.display = 'block'; // Show the error message
            } else {
                // If no error message, redirect to the project's detail page
                var projectId = data.project_id; // Fetch the project ID from the response
                window.location.href = 'http://127.0.0.1:8000/project/' + projectId; // Redirect to the project's detail page
            }
        })
        .catch(error => console.error('Error:', error));
    });
});



</script>